<div *ngIf="video as v; else loading" class="container py-3">
  <!-- Success message when video is loaded - moved to top of page -->
  <div *ngIf="(!isLoading && !errorMsg && (embedUrl || blobUrl))" class="alert alert-success mb-3">
    <i class="bi bi-check-circle-fill me-2"></i>
    <strong>الفيديو جاهز للمشاهدة</strong>
    <p class="mb-0 small">يمكنك تشغيل الفيديو باستخدام أزرار التحكم أدناه</p>
  </div>
  <h2 class="mb-3">{{ v.videoTitle }}</h2>
  <div class="player">
    <iframe *ngIf="embedUrl" [src]="embedUrl" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>
    <video *ngIf="!embedUrl && blobUrl" [src]="blobUrl" controls (error)="onVideoError($event)" width="100%" height="auto"></video>
    <div *ngIf="!embedUrl && !blobUrl && !isLoading && !errorMsg" class="alert alert-warning">No video URL available</div>
    <div *ngIf="isLoading && !errorMsg" class="alert alert-info">جاري تحميل الفيديو... يرجى الانتظار</div>
  </div>
  <div *ngIf="errorMsg" class="alert alert-warning mt-3" role="alert">
    <h5 class="alert-heading">تنبيه</h5>
    <p>{{ errorMsg }}</p>
    <hr>
    <p class="mb-0">إذا استمرت المشكلة، يمكنك:</p>
    <ul class="mb-0">
      <li>تحديث الصفحة</li>
      <li>التحقق من اتصال الإنترنت</li>
      <li>الاتصال بدعم الموقع</li>
    </ul>
  </div>
  <div *ngIf="v.duration && v.duration > 0" class="mt-3 text-muted">مدة الفيديو: {{ v.duration }} ثانية</div>
</div>

<ng-template #loading>
  <div class="py-5 text-center">
    <div class="spinner-border text-primary" role="status">
      <span class="visually-hidden">جاري التحميل...</span>
    </div>
    <p class="mt-2">جاري تحضير الفيديو للمشاهدة...</p>
  </div>
</ng-template>